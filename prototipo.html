<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FridgeManager Prototipo Funcional</title>
  <style>
    /* --- ESTILOS (CSS) --- */
    :root {
      --primary: #007aff;
      --danger: #ff3b30;
      --success: #34c759;
      --bg: #f2f2f7;
      --card: #ffffff;
    }

    body {
      background-color: #e5e5f7;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      color: #1c1c1e;
    }

    #device {
      width: 375px;
      height: 812px;
      background-color: var(--bg);
      border-radius: 40px;
      border: 12px solid #333;
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    }

    /* Notch */
    #notch {
      position: absolute; top: 0; left: 50%; transform: translateX(-50%);
      width: 150px; height: 30px; background: #333;
      border-bottom-left-radius: 16px; border-bottom-right-radius: 16px; z-index: 10;
    }

    /* Header */
    header {
      background: rgba(255,255,255,0.95);
      padding: 50px 20px 10px;
      border-bottom: 1px solid #c6c6c8;
      display: flex; justify-content: space-between; align-items: center;
    }
    h1 { font-size: 28px; font-weight: 700; margin: 0; }
    .btn-add { font-size: 28px; color: var(--primary); background: none; border: none; cursor: pointer; }

    /* Lista */
    main { flex: 1; overflow-y: auto; padding: 15px; padding-bottom: 100px; }

    .card {
      background: var(--card);
      padding: 15px; margin-bottom: 10px;
      border-radius: 12px;
      display: flex; justify-content: space-between; align-items: center;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .card-info h3 { margin: 0 0 5px 0; font-size: 17px; }
    .card-info span { font-size: 13px; color: #8e8e93; }

    .controls { display: flex; align-items: center; gap: 8px; }

    .btn-circle {
      width: 30px; height: 30px; border-radius: 50%;
      border: none; background: #f2f2f7; color: var(--primary);
      font-size: 18px; font-weight: bold; cursor: pointer;
      display: flex; align-items: center; justify-content: center;
    }

    .qty { font-weight: 600; min-width: 20px; text-align: center; }

    .btn-buy { background: var(--success); color: white; width: auto; padding: 0 10px; border-radius: 15px; font-size: 12px; height: 30px; }
    .btn-del { color: var(--danger); background: none; }

    /* Tab Bar */
    .tab-bar {
      position: absolute; bottom: 0; width: 100%; height: 85px;
      background: rgba(255,255,255,0.95); border-top: 1px solid #c6c6c8;
      display: flex; justify-content: space-around; padding-top: 10px;
    }
    .tab { display: flex; flex-direction: column; align-items: center; color: #999; cursor: pointer; flex: 1; }
    .tab.active { color: var(--primary); }
    .tab-icon { font-size: 24px; margin-bottom: 2px; }
    .tab-label { font-size: 10px; font-weight: 500; }

    /* Modal */
    #modal-overlay {
      position: absolute; inset: 0; background: rgba(0,0,0,0.4);
      display: none; align-items: flex-end; z-index: 20;
    }
    #modal-overlay.open { display: flex; }
    .modal-body {
      background: white; width: 100%; padding: 20px;
      border-radius: 20px 20px 0 0; animation: slideUp 0.3s;
    }
    input { width: 100%; padding: 15px; margin: 15px 0; background: #f2f2f7; border: none; border-radius: 10px; font-size: 16px; box-sizing: border-box; }
    .modal-actions { display: flex; gap: 10px; }
    .btn-modal { flex: 1; padding: 15px; border-radius: 12px; border: none; font-weight: 600; cursor: pointer; }
    .btn-confirm { background: var(--primary); color: white; }

    @keyframes popIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
    .empty-msg { text-align: center; color: #999; margin-top: 50px; }
  </style>
</head>
<body>

<div id="device">
  <div id="notch"></div>

  <header>
    <h1 id="header-title">Geladeira</h1>
    <button class="btn-add" onclick="openModal()">+</button>
  </header>

  <main id="list-area"></main>

  <div class="tab-bar">
    <div class="tab active" onclick="switchTab('fridge')">
      <span class="tab-icon">‚ùÑÔ∏è</span>
      <span class="tab-label">Geladeira</span>
    </div>
    <div class="tab" onclick="switchTab('shopping')">
      <span class="tab-icon">üõí</span>
      <span class="tab-label">Compras</span>
    </div>
  </div>

  <div id="modal-overlay">
    <div class="modal-body">
      <h3>Novo Item</h3>
      <input type="text" id="input-name" placeholder="O que voc√™ comprou?">
      <div class="modal-actions">
        <button class="btn-modal" onclick="closeModal()">Cancelar</button>
        <button class="btn-modal btn-confirm" onclick="confirmAdd()">Salvar</button>
      </div>
    </div>
  </div>
</div>

<script>
  // --- L√ìGICA DO APP (Swift Logic Blueprint) ---

  // Estado Global (Dados)
  let appData = {
    fridge: [],   // Itens na geladeira
    shopping: []  // Itens para comprar
  };

  let currentTab = 'fridge'; // 'fridge' ou 'shopping'

  // 1. CARREGAR DADOS (Simula CoreData/UserDefaults)
  function loadData() {
    const saved = localStorage.getItem('myFridgeApp_v1');
    if (saved) {
      appData = JSON.parse(saved);
    } else {
      // Dados iniciais de exemplo
      appData.fridge = [
        { id: 1, name: 'Ovos', qty: 6 },
        { id: 2, name: 'Leite', qty: 1 }
      ];
    }
    render();
  }

  // 2. SALVAR DADOS (Persist√™ncia)
  function saveData() {
    localStorage.setItem('myFridgeApp_v1', JSON.stringify(appData));
    render(); // Atualiza a tela sempre que salva
  }

  // 3. RENDERIZA√á√ÉO DA UI (Simula SwiftUI View Body)
  function render() {
    const listArea = document.getElementById('list-area');
    const list = currentTab === 'fridge' ? appData.fridge : appData.shopping;

    listArea.innerHTML = ''; // Limpa tela

    if (list.length === 0) {
      listArea.innerHTML = `<p class="empty-msg">${currentTab === 'fridge' ? 'Geladeira vazia.' : 'Lista de compras vazia.'}</p>`;
      return;
    }

    // Cria os cards (Simula ForEach)
    list.forEach(item => {
      const div = document.createElement('div');
      div.className = 'card';

      // HTML condicional dependendo da aba
      let controlsHTML = '';

      if (currentTab === 'fridge') {
        // Controles da Geladeira (+ / -)
        controlsHTML = `
                    <button class="btn-circle" onclick="changeQty(${item.id}, -1)">-</button>
                    <span class="qty">${item.qty}</span>
                    <button class="btn-circle" onclick="changeQty(${item.id}, 1)">+</button>
                `;
      } else {
        // Controles de Compras (Comprar / Deletar)
        controlsHTML = `
                    <span class="qty">${item.qty}x</span>
                    <button class="btn-circle btn-buy" onclick="markAsBought(${item.id})">‚úî Comprar</button>
                    <button class="btn-circle btn-del" onclick="deleteItem(${item.id})">‚úï</button>
                `;
      }

      div.innerHTML = `
                <div class="card-info">
                    <h3>${item.name}</h3>
                    <span>${currentTab === 'fridge' ? 'Em estoque' : 'Precisa comprar'}</span>
                </div>
                <div class="controls">${controlsHTML}</div>
            `;
      listArea.appendChild(div);
    });

    // Atualiza T√≠tulo
    document.getElementById('header-title').innerText = currentTab === 'fridge' ? 'Minha Geladeira' : 'Lista de Compras';
  }

  // --- A√á√ïES DO USU√ÅRIO (L√≥gica de Neg√≥cio) ---

  // Adicionar novo item
  function confirmAdd() {
    const input = document.getElementById('input-name');
    const name = input.value.trim();
    if (!name) return;

    const newItem = { id: Date.now(), name: name, qty: 1 };

    if (currentTab === 'fridge') {
      appData.fridge.push(newItem);
    } else {
      appData.shopping.push(newItem);
    }

    closeModal();
    saveData();
  }

  // Alterar Quantidade (L√≥gica Cr√≠tica para o MVP)
  function changeQty(id, delta) {
    const item = appData.fridge.find(i => i.id === id);
    if (!item) return;

    item.qty += delta;

    // REGRA DE NEG√ìCIO: Se zerar na geladeira -> Mover para compras
    if (item.qty <= 0) {
      const move = confirm(`Acabou ${item.name}. Mover para lista de compras?`);

      // Remove da geladeira
      appData.fridge = appData.fridge.filter(i => i.id !== id);

      if (move) {
        // Verifica se j√° existe na lista de compras para n√£o duplicar
        const existsInShopping = appData.shopping.find(s => s.name === item.name);
        if (existsInShopping) {
          existsInShopping.qty += 1;
        } else {
          appData.shopping.push({ id: Date.now(), name: item.name, qty: 1 });
        }
        alert(`${item.name} adicionado √† lista de compras!`);
      }
    }
    saveData();
  }

  // Marcar como comprado (Ciclo Compras -> Geladeira)
  function markAsBought(id) {
    const itemIndex = appData.shopping.findIndex(i => i.id === id);
    if (itemIndex === -1) return;

    const item = appData.shopping[itemIndex];

    // Remove das compras
    appData.shopping.splice(itemIndex, 1);

    // Adiciona/Atualiza na Geladeira
    const existingInFridge = appData.fridge.find(f => f.name === item.name);
    if (existingInFridge) {
      existingInFridge.qty += item.qty;
    } else {
      appData.fridge.push(item);
    }

    saveData();
    // Feedback visual simples
    alert(`${item.name} movido para a Geladeira!`);
  }

  function deleteItem(id) {
    appData.shopping = appData.shopping.filter(i => i.id !== id);
    saveData();
  }

  // --- NAVEGA√á√ÉO ---
  function switchTab(tab) {
    currentTab = tab;
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    // Gambiarra visual para selecionar a tab certa
    const index = tab === 'fridge' ? 0 : 1;
    document.querySelectorAll('.tab')[index].classList.add('active');
    render();
  }

  // --- MODAL ---
  function openModal() {
    document.getElementById('modal-overlay').classList.add('open');
    document.getElementById('input-name').focus();
  }
  function closeModal() {
    document.getElementById('modal-overlay').classList.remove('open');
    document.getElementById('input-name').value = '';
  }

  // Inicializa√ß√£o
  loadData();

</script>

</body>
</html>